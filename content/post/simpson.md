---
title: Simpson's Paradox
subtitle: How Simpson's Paradox Distorts the Data?
date: 2023-04-23
tags: ["Reasoning", "Simpson's Paradox"]
bigimg: [{ src: "/img/pan.jpg", desc: "earphone" }]
---

# 什么是辛普森悖论？

<br>

辛普森悖论是统计学中的一种现象，它指的是，趋势在几组数据中出现，然而当这些组被合并之后，趋势却消失或是被反转了。为什么这样的现象会发生呢？要想分析悖论产生的原因，我们先看一个案例：
下表是一场篮球比赛的投篮得分情况：

![image.png](/img/table1.png)

由图可以算出，A 队的命中率为 **28/60=46.7%**；B 队队命中率为 **26/60=43.3%**  
从这个表看来，似乎 A 队的投篮表现更好，因为它的命中率高于 B 队，但是事实真是这样吗？让我们进一步看看这些数据。

事实上，篮球比赛中有两种类型的投篮得分，分别有两分球和三分球，当我们将投篮数据按投篮类型划分之后，得到了这样的表：

![image.png](/img/table2.png)

由图可以算出，A 队的命中率为 **28/60=46.7%**；B 队队命中率为 **26/60=43.3%**

通过计算，我们可以得到 A 队的 2 分命中率为 **25/50=50%**，3 分命中率为 **3/10=30%**，而 B 队的 2 分命中率为 **16/30=53.3%**，3 分命中率为**10/30=33.3%**。

令人震惊！结果显示了无论是 2 分还是 3 分，B 队的命中率都大于 A 队，然而在将数据汇总后，该趋势被反转了。这是为什么呢？

# 潜在变量在作怪

结果似乎看上去很奇怪，当查看总的投篮情况时，A 队的表现好；但是当单独看 2 分球和 3 分球的投篮情况时，B 队在两类投篮上都更胜一筹。为什么会出现这种情况呢？

其实，这是因为一些潜在的因素，影响了最终的结果。表一和表二之所以会产生不一样的结果，是因为表二的数据中存在潜在变量，即投篮的类型（2 分球和 3 分球），这个变量存在一些潜在的因素，对汇总后的结果（表一）产生了影响。

|     | 2-points | 3-points |
| --- | -------- | -------- |
| A   | 50       | 30       |
| B   | 10       | 30       |

我们都知道，离篮筐越远，投中的命中率就越低，因此三分球相对于二分球命中率较低，A 队在 60 球中更多地选择了容易得分的 2 分球，占到了 50/60=83.3%的比例，而 B 队只投了 30 个 2 分球，占 30/60=50%。

2 分球的比例在投球总数中占比越高，意味着更容易投中，投球的总命中率也会被带高，这导致了在总得分中，A 队获得了更高的命中率。汇总后的数据，并没有考虑到投球类型对命中率的影响，因此，表一传递了错误的信息。  
像这种当合并数据后，使得原有数据特征消失或呈现与其完全相反的趋势的现象，被称为辛普森悖论。

# 统计数据的陷阱

正是由于辛普森悖论的存在，现实生活中任意使用统计分析会产生很多错误的结论。一方面，因为数据总是可以以各种形式和分类被比较，可以产生无限的潜在变量，总是可以用某个潜在变量得出某种结论，容易被人利用来故意误导别人。另一方面是，表面的数据可能会掩盖更「根本的原因」，使我们漏掉重要的信息，正如上面的例子。

### 辛普森悖论可能会在这两种情境下出现：

一种情况是某一分组产生结论概率更高，如刚刚那个例子，潜在变量为投篮的类型，它存在着这样的关系：2 分球命中率比 3 分球命中率高，因此投篮类型的比例会影响到最终的结论或者说响应变量（这里指总命中率）的结果。
另一种可能的情况是分组间的基数差异。当基数越大时，会导致变量的影响被放大，因变量的数量也更多（暂且把它称为人流效应吧）。

如在将不同设备的 IOS 和 Android 合并之后，出现了辛普森现象，不同设备上 IOS 的转化率均高于 Android，而合并设备后全设备上 Android 转换率却比 IOS 高。这主要是因为两类操作系统的使用人数基数的不同所导致的结果，如果要避免这种现象，就得考虑给分组加以权重再进行合并，以一定的系数消除分组资料基数差异带来的影响。

# 时刻警惕辛普森悖论的存在

在现实情形中，很多情况下都会产生辛普森悖论。分析数据的时候，要设立更多的角度去综合评判。
产品行业的一个常见做法时，对于目标变量，思考更多的前置目标；如上例的设备转换率，根据漏斗模型的话，思考转换率之前会有分发量、用户量、运营思路、口碑等指标，实现最终的转化往往是以这些前置目标做铺垫，如：

> 大多数的用户是不会付费的，免费产品的综合付费转化率比较低，是因为把付费玩家和非付费玩家综合到了一起，所以任何对免费用户的衡量都是非常低的。因为大多数的用户是不付费的，所以 ARPU 以及 ARPPU 相差很多。

# A/B 测试中的误区

A/B 测试中，常见的错误出现在分组上；对于 A/B 测试，要达到随机分组和最低标准的合格样本量，数据才有基本的可信度，能进行进一步的分析。
避免辛普森悖论的关键是要同时参考不同用户间的事实全貌，即进行用户分析。

1. 准切的用户分群尤其是在免费产品当中，平均用户不仅不存在，而且是误导研发的因素之一，所以关键在于利用特征将用户进行合理划分。
2. 在产品中，普适型数据参考价值不大，需要细分到设备、地域、渠道、消费能力等进行对比才有价值。
3. 考虑分组基数的差异，斟酌个别分组的权重，同时也要考虑该请假下是否还有别的潜在因素存在。

> 该段摘录于 [人人都是产品经理｜数据分析必须警惕的坑：辛普森悖论](https://www.woshipm.com/data-analysis/1061642.html)
